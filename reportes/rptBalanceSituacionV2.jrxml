<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptBalanceSituacionV2" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="5ac19e05-6557-4630-b8d3-5de6507c3dc2">
	<property name="ireport.zoom" value="1.3310000000000026"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="93"/>
	<parameter name="empresa" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="cedulajuridica" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="ruta" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="periodo_inicio" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="periodo_final" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="nEmpresa" class="java.lang.Long">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
 b.idcuentamayor,
         b.idsubcuentamayor,
		 b.idcuentamenor,
	concat(b.idcuentamayor,'-',b.idsubcuentamayor) cuentaKey,
    case when b.idcuentamayor::int =  100 then 'ACTIVOS' else 'PASIVOS' END grupo,
	 b.cuentamayor,
	 b.subcuentamayor,
	 b.cuentamenor,
	 sum(a.balance_final)
from conta.balances a
inner join conta.cuentacompuesta b on a.idcuentacompuesta  = b.idcuentacompuesta
where   a.empresa = $P{nEmpresa} and
        a.intervalo between $P{periodo_inicio} and $P{periodo_final} and
concat(b.idcuentamayor,'-',b.idsubcuentamayor) in ('100-000','100-001','200-000','200-001','300-000','300-001')
group by

		 b.idcuentamayor,
         b.idsubcuentamayor,
		 b.idcuentamenor,
		 concat(b.idcuentamayor,'-',b.idsubcuentamayor) ,
 b.cuentamayor,
b.subcuentamayor,
		 b.cuentamenor
having
sum(a.balance_final)<>0
order by
		 b.idcuentamayor,
         b.idsubcuentamayor,
		 b.idcuentamenor,
		 concat(b.idcuentamayor,'-',b.idsubcuentamayor),
 b.cuentamayor,
		 b.subcuentamayor,
		 b.cuentamenor]]>
	</queryString>
	<field name="idcuentamayor" class="java.lang.String"/>
	<field name="idsubcuentamayor" class="java.lang.String"/>
	<field name="idcuentamenor" class="java.lang.String"/>
	<field name="cuentakey" class="java.lang.String"/>
	<field name="grupo" class="java.lang.String"/>
	<field name="cuentamayor" class="java.lang.String"/>
	<field name="subcuentamayor" class="java.lang.String"/>
	<field name="cuentamenor" class="java.lang.String"/>
	<field name="sum" class="java.lang.Double"/>
	<variable name="sum_1" class="java.lang.Double" resetType="Group" resetGroup="grupo" calculation="Sum">
		<variableExpression><![CDATA[$F{sum}]]></variableExpression>
	</variable>
	<variable name="sum_2" class="java.lang.Double" resetType="Group" resetGroup="idsubcuentamayor" calculation="Sum">
		<variableExpression><![CDATA[$F{sum}]]></variableExpression>
	</variable>
	<group name="grupo">
		<groupExpression><![CDATA[$F{grupo}]]></groupExpression>
		<groupHeader>
			<band height="20">
				<rectangle>
					<reportElement x="0" y="0" width="572" height="20" forecolor="#FFFFFF" backcolor="#C3E9E9" uuid="f4c7f9ee-1a0f-41f3-8ede-11445c426151"/>
				</rectangle>
				<textField>
					<reportElement x="5" y="0" width="226" height="20" uuid="9242d833-cb4b-4aad-97a0-ae7a2d336088"/>
					<textElement verticalAlignment="Middle">
						<font size="10" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{grupo}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="29">
				<rectangle>
					<reportElement x="2" y="3" width="572" height="21" forecolor="#FFFFFF" backcolor="#C3E9E9" uuid="05a753dc-2f23-4a07-9bf8-ab46aa26439f"/>
				</rectangle>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement x="472" y="5" width="98" height="17" uuid="51026113-8369-41f1-9cf2-9e4d45858083"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_1}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement x="470" y="4" width="100" height="1" uuid="8ea1b825-bd79-4814-a86c-ccd151106234"/>
					<graphicElement>
						<pen lineStyle="Double"/>
					</graphicElement>
				</line>
				<line>
					<reportElement x="470" y="22" width="100" height="1" uuid="8de0877d-b2a4-43f7-a140-03936b4c401f"/>
					<graphicElement>
						<pen lineStyle="Double"/>
					</graphicElement>
				</line>
				<textField>
					<reportElement x="15" y="5" width="226" height="20" uuid="ea2b4c4a-9061-4215-a71c-e872d196d5b7"/>
					<textElement verticalAlignment="Middle">
						<font size="10" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL DE " + $F{grupo}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="idsubcuentamayor">
		<groupExpression><![CDATA[$F{idsubcuentamayor}]]></groupExpression>
		<groupHeader>
			<band height="22">
				<textField>
					<reportElement x="47" y="0" width="346" height="20" uuid="65710a32-bdbe-461f-9f69-baad75d56e69"/>
					<textElement verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{subcuentamayor}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="25">
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement x="472" y="4" width="98" height="16" uuid="fe6f2bb4-66af-4d11-a8a0-b04f42bb5bb9"/>
					<textElement textAlignment="Right" verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$V{sum_2}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement x="316" y="4" width="100" height="1" uuid="e2c88640-b2f3-4808-9733-655e6b788b44"/>
					<graphicElement>
						<pen lineStyle="Dashed"/>
					</graphicElement>
				</line>
				<line>
					<reportElement x="470" y="20" width="100" height="1" uuid="e279fadd-9ac0-4e6b-befa-2682eddb813d"/>
					<graphicElement>
						<pen lineStyle="Dashed"/>
					</graphicElement>
				</line>
				<textField>
					<reportElement x="47" y="4" width="184" height="20" uuid="c8c62f85-34ea-425c-8218-cd55de078612"/>
					<textElement verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL DE " + $F{subcuentamayor}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="cuentamenor">
		<groupExpression><![CDATA[$F{cuentamenor}]]></groupExpression>
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="79" splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="120" splitType="Stretch">
			<textField pattern="dd-MMM-yy">
				<reportElement x="521" y="4" width="51" height="8" uuid="037d4777-6ca4-4e5e-9d22-58ce7581d70c"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="498" y="24" width="23" height="9" uuid="a511c3a6-ff4e-4d6a-aecb-4d0c97b5012e"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[Hora    :]]></text>
			</staticText>
			<textField evaluationTime="Report">
				<reportElement x="541" y="34" width="29" height="8" uuid="9d73bdc9-95c8-4609-a600-25b4aa47ea09"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="169" y="76" width="256" height="22" uuid="735eb190-1258-4de4-bf14-4c13ec6feebe"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="18" isBold="true" isUnderline="true"/>
				</textElement>
				<text><![CDATA[BALANCE DE SITUACION]]></text>
			</staticText>
			<line>
				<reportElement x="496" y="13" width="78" height="1" uuid="600bd5dc-f5ab-44da-a5ba-d75eddafe35c"/>
				<graphicElement>
					<pen lineWidth="0.5"/>
				</graphicElement>
			</line>
			<rectangle radius="2">
				<reportElement x="496" y="4" width="78" height="39" uuid="db56516d-2f83-4340-ae88-a69093ec4afd"/>
				<graphicElement>
					<pen lineWidth="0.5"/>
				</graphicElement>
			</rectangle>
			<line>
				<reportElement x="496" y="33" width="78" height="1" uuid="4e577f07-dd8c-4ae5-a5fd-51b7193f1ed4"/>
				<graphicElement>
					<pen lineWidth="0.5"/>
				</graphicElement>
			</line>
			<textField pattern="h.mm a">
				<reportElement x="521" y="23" width="51" height="10" uuid="1854676f-b931-419a-97c7-546cbc7fc4bd"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="496" y="23" width="78" height="1" uuid="9022c923-b933-46c4-b486-255654c30970"/>
				<graphicElement>
					<pen lineWidth="0.5"/>
				</graphicElement>
			</line>
			<textField>
				<reportElement x="201" y="45" width="176" height="20" uuid="2d6fff3f-ac27-4ef4-8bdd-4c155306c766"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{cedulajuridica}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="496" y="34" width="45" height="8" uuid="47bdf61f-ca4b-475c-a728-884e010be14a"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+"/"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="201" y="25" width="176" height="20" uuid="d3b89a71-5c45-42a7-befe-05c995a84b2e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{empresa}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="5" y="3" width="196" height="42" uuid="ec446cf7-1784-4139-8241-a5a577e684fb"/>
				<imageExpression><![CDATA[$P{ruta}+"head.jpg"]]></imageExpression>
			</image>
			<staticText>
				<reportElement x="498" y="14" width="76" height="9" uuid="beed2969-cd97-4f2f-9023-ed713a62718b"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[Usuario: Sistema]]></text>
			</staticText>
			<staticText>
				<reportElement x="498" y="4" width="23" height="9" uuid="05b17553-da2c-4adb-81fe-1cb26c70f081"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[Fecha  :]]></text>
			</staticText>
			<staticText>
				<reportElement x="192" y="100" width="69" height="20" uuid="fa6a7bba-afaa-4464-a16e-422430f0e9e6"/>
				<textElement verticalAlignment="Middle"/>
				<text><![CDATA[Periodo desde:]]></text>
			</staticText>
			<textField>
				<reportElement x="267" y="100" width="49" height="20" uuid="1ead342b-f3ae-4330-8f54-059e146ca6b4"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$P{periodo_inicio}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="322" y="100" width="27" height="20" uuid="2f10022d-715b-4520-82b2-8bef5d2d225c"/>
				<textElement verticalAlignment="Middle"/>
				<text><![CDATA[hasta]]></text>
			</staticText>
			<textField>
				<reportElement x="357" y="100" width="51" height="20" uuid="dec65eb8-57fe-4ee2-8823-79fdaa1ea331"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$P{periodo_final}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<textField>
				<reportElement x="69" y="0" width="274" height="15" uuid="31d8e184-cc26-4460-812d-93930e6fed32"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{cuentamenor}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00">
				<reportElement x="316" y="0" width="100" height="15" uuid="12de3267-b5a6-4b18-bf84-22131a07c58e"/>
				<textElement textAlignment="Right" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{sum}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
